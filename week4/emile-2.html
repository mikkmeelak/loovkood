<!DOCTYPE html>
<html>
<head>
	<title>LOOVKOOD</title>
	<style>
		/* here you can change the background */
		body { background-color: #366575; }
		canvas { position: fixed; top: 0; right: 0; bottom: 0; left: 0; }
		img { display: none; }
	</style>
</head>

<body>
	<canvas id="canvas" resize></canvas>
</body>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/paper.js/0.9.25/paper-full.min.js"></script>
<script type="text/javascript">
	paper.install(window);

	window.onload = function() {
		paper.setup('canvas');
		view.viewSize = [ window.innerWidth, window.innerHeight ];
		window.onresize = function(event) { view.viewSize = [ window.innerWidth, window.innerHeight ]; }
		var tool = new Tool();


// VARIABLES________________________________________________________________________________

		var width = view.size.width;
		var height = view.size.height;
		var ratio = 0;
		var nose = [];
		var face = [];
		var eyeL = [];
		var eyeR = [];
		var eyes = [];
		var mouth = [];
		var eyebrowsL = [[]];
		var eyebrowsR = [[]];
		var points_nose = [];
		var smooth_pos_mouse_x;
		var smooth_pos_mouse_y;
		var pos_mouse_x;
		var pos_mouse_y;
		var nb_chara_loop = 0;

// FUNCTIONS______________________________________________________________________________

		// Calculate the ratio of the window
		function Ratio(){
			var diff = width - height

			if(diff > 0){
				ratio = height * height / 462000
			} else {
				ratio = width * width / 462000
			};
		};

		function RandPoint(max) {
			var result = parseInt(max * Math.random())
			return result
		}

		function Character(nb_chara) {
			// Face ##################################
			var face_size = (parseInt(Math.random() * 50) + 100) * ratio
			var chose = parseInt(Math.random() * 3)
			console.log(face_size)

			if (chose == 0) {
				face[nb_chara] = new Path.Circle({
					radius: face_size
				});
			} else if (chose == 1) {
				face[nb_chara] = new Path.RegularPolygon({
					sides: 3,
					radius: face_size
				});
			} else if (chose == 2) {
				face[nb_chara] = new Path.Rectangle({
					size: face_size + 40
				});
			}
			face[nb_chara].position = view.center;
			face[nb_chara].fillColor = [Math.random(), Math.random(), Math.random()];

			// Mouth ##################################
			var mouth_color = [Math.random(), Math.random(), Math.random()];
			var mouth_arcY = - 20
			mouth[nb_chara] = new Path.Arc({
				from: [(width / 2 - 20) * ratio, (height / 2 + 70) * ratio],
				through: [(width / 2 - 20) * ratio, (height / 2 + 70 + mouth_arcY) * ratio],
				to: [(width / 2 + 20) * ratio, (height / 2 + 70) * ratio],
				fillColor: mouth_color
			});

			var ratio_face = face_size / 168.5
			mouth[nb_chara].scale(1 * ratio_face , 1 * ratio_face)

			// Nose ##################################
			nose[nb_chara] = new Path();
			for (var nb_nose = 0; nb_nose < 3; nb_nose++) {
				points_nose[nb_nose] = new Point(RandPoint(10) + width / 2, RandPoint(50) + height / 2);
				console.log(points_nose[nb_nose]);
				nose[nb_chara].add(points_nose[nb_nose]);
			}
			nose[nb_chara].strokeColor = [Math.random(), Math.random(), Math.random()];
			nose[nb_chara].strokeWidth = (Math.random() * 6 + 2) * ratio;
			//nose.selected = true;

			// Eyes ##################################
			var eye_size = (parseInt(Math.random() * 10) + 5);
			var eye_color = [Math.random(), Math.random(), Math.random()];

			eyeL[nb_chara] = new Path.Circle({
				radius: eye_size + (parseInt(Math.random() * 5)) * ratio,
			});
			eyeR[nb_chara] = new Path.Circle({
				radius: eye_size + (parseInt(Math.random() * 5)) * ratio
			});
			eyeR[nb_chara].fillColor = eye_color;
			eyeL[nb_chara].fillColor = eye_color;
			eyeR[nb_chara].position.x = view.center.x + 20 * ratio;
			eyeR[nb_chara].position.y = view.center.y - 20 * ratio;
			eyeL[nb_chara].position.x = view.center.x - 20 * ratio;
			eyeL[nb_chara].position.y = view.center.y - 20 * ratio;
			eyes[nb_chara] = new Group([eyeR[nb_chara], eyeL[nb_chara]])
			console.log(eyes[nb_chara])

			// Eyebrows ##################################
			var hairPosY_from = (eyeR[nb_chara].position.y + Math.random() * 5 - 20);
			var hairPosY_to = (hairPosY_from + Math.random() * 5);
			var hairPosX_from = (eyeR[nb_chara].position.x - 15 + Math.random() * 20);
			var hairPosX_to = (eyeR[nb_chara].position.x - 15 + Math.random() * 60);
			var eyebrows_width = (Math.random() * 10 + 1) * ratio;
			var eyebrows_color = [Math.random(), Math.random(), Math.random()];

			for ( var nb_hair = 0; nb_hair < Math.random() * 5 + 5; nb_hair++) {
				eyebrowsR[nb_hair] = new Path.Line({
					from: [hairPosX_from, hairPosY_from],
					to: [hairPosX_to, hairPosY_to]
				});
				eyebrowsL[nb_hair] = new Path.Line({
					from: [width - hairPosX_from, hairPosY_from],
					to: [width - hairPosX_to, hairPosY_to]
				});
				eyebrowsL[nb_hair].scale(-1, -1);
				eyebrowsR[nb_hair].strokeColor = eyebrows_color;
				eyebrowsR[nb_hair].strokeWidth = eyebrows_width
				eyebrowsL[nb_hair].strokeColor = eyebrows_color;
				eyebrowsL[nb_hair].strokeWidth = eyebrows_width

				// reset of the values
				hairPosY = (eyeR[nb_chara].position.y + Math.random() * 5 - 20);
				hairPosY_to = (hairPosY_from + Math.random() * 5);
				hairPosX_from = (eyeR[nb_chara].position.x - 15 + Math.random() * 20);
				hairPosX_to = (eyeR[nb_chara].position.x - 15 + Math.random() * 60);
				eyebrows_width = (Math.random() * 10 + 1) * ratio;
			};
		};

// SCRIPT___________________________________________________________________________________

		Ratio();
		for (nb_chara_loop; nb_chara_loop < 2;) {
			Character(nb_chara_loop);
			project.activeLayer.position.x = project.activeLayer.position.x + 280 * ratio
			nb_chara_loop = nb_chara_loop + 1
		}


		view.onMouseMove = function(event){
			pos_mouse_x = event.point.x;
			pos_mouse_y = event.point.y;
			if (pos_mouse_x < width / 2) {
				smooth_pos_mouse_x = pos_mouse_x + ((width / 2) - pos_mouse_x) / (1.01 * ratio)
			} else {
				smooth_pos_mouse_x = pos_mouse_x + ((width / 2) - pos_mouse_x) / (1.01 * ratio)
			};
			if (pos_mouse_y < width / 2) {
				smooth_pos_mouse_y = pos_mouse_y + ((height / 2) - pos_mouse_y) / (1.01 * ratio)
			} else {
				smooth_pos_mouse_y = pos_mouse_y + ((height / 2) - pos_mouse_y) / (1.01 * ratio)
			};
		};

		view.onFrame = function(event) {
			for (var x = 0; x < nb_chara_loop; x++)
			eyes[x].position = [(smooth_pos_mouse_x - (x * 280) * ratio), smooth_pos_mouse_y];
		}
		project.activeLayer.position = view.center






	};

</script>
</html>
